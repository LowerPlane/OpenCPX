$schema: "http://json-schema.org/draft-07/schema#"
$id: "https://opencts.io/spec/v1/cts-schema.yaml"
title: OpenCTS v1 Schema
description: Schema definition for Compliance Telemetry Standard (CTS) v1
type: object
properties:
  version:
    type: string
    description: Schema version (e.g., v1)
    pattern: "^v[0-9]+$"

  timestamp:
    type: string
    format: date-time
    description: ISO8601 timestamp of telemetry generation

  compliance_posture:
    type: string
    enum: [compliant, partially_compliant, non_compliant, unknown]
    description: Overall compliance status

  frameworks:
    type: array
    description: List of compliance frameworks evaluated
    items:
      type: object
      properties:
        name:
          type: string
          description: Framework name (e.g., SOC2, ISO27001)
        status:
          type: string
          enum: [compliant, partial, non_compliant]
          description: Compliance state for this framework
        score:
          type: number
          minimum: 0
          maximum: 1
          description: Compliance score (0â€“1 scale)
        controls:
          type: array
          description: Control-level compliance within this framework
          items:
            type: object
            properties:
              id:
                type: string
                description: Control identifier (e.g., CC1.1, A.5)
              title:
                type: string
                description: Control title or description
              status:
                type: string
                enum: [compliant, partial, non_compliant]
                description: Control-level compliance
              evidence_ref:
                type: string
                description: URI, hash, or presigned URL for supporting evidence
            required: [id, status]
      required: [name, status, score]

  evidence_refs:
    type: array
    description: Top-level evidence references related to posture summary
    items:
      type: string

  extensions:
    type: object
    description: Vendor-specific or future extensions
    additionalProperties: true

required: [version, timestamp, compliance_posture, frameworks]
additionalProperties: false
